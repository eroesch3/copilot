{"ast":null,"code":"import _objectSpread from \"/Users/user/ga/project4/copilot/copilot_app/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/user/ga/project4/copilot/copilot_app/client/src/App.js\";\nimport React, { Component } from 'react';\nimport { Route, Link } from 'react-router-dom';\nimport { withRouter } from 'react-router';\nimport decode from 'jwt-decode'; // import TeachersView from './components/TeachersView';\n// import TeacherPage from './components/TeacherPage';\n// import CreateTeacher from './components/CreateTeacher'\n\nimport Login from './components/Login';\nimport Register from './components/Register';\nimport { // createTeacher,\n// readAllTeachers,\n// updateTeacher,\n// destroyTeacher,\nloginUser, registerUser } from './services/api-helper';\nimport './App.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activities: [],\n      activityForm: {\n        name: \"\",\n        category: \"\"\n      },\n      currentUser: null,\n      authFormData: {\n        username: \"\",\n        email: \"\",\n        password: \"\"\n      }\n    };\n    this.handleFormChange = this.handleFormChange.bind(this);\n    this.mountEditForm = this.mountEditForm.bind(this);\n    this.editActivity = this.editActivity.bind(this);\n    this.deleteActivity = this.deleteActivity.bind(this);\n    this.newActivity = this.newActivity.bind(this);\n    this.handleLoginButton = this.handleLoginButton.bind(this);\n    this.handleLogin = this.handleLogin.bind(this);\n    this.handleRegister = this.handleRegister.bind(this);\n    this.handleLogout = this.handleLogout.bind(this);\n    this.authHandleChange = this.authHandleChange.bind(this);\n  }\n\n  componentDidMount() {\n    this.getTeachers();\n    const checkUser = localStorage.getItem(\"jwt\");\n\n    if (checkUser) {\n      const user = decode(checkUser);\n      this.setState({\n        currentUser: user\n      });\n    }\n  }\n\n  async getTeachers() {\n    const teachers = await readAllTeachers();\n    this.setState({\n      teachers\n    });\n  }\n\n  async newActivity(e) {\n    e.preventDefault();\n    const teacher = await createTeacher(this.state.teacherForm);\n    this.setState(prevState => ({\n      teachers: [...prevState.teachers, teacher],\n      teacherForm: {\n        name: \"\",\n        photo: \"\"\n      }\n    }));\n  }\n\n  async editActivity() {\n    const teacherForm = this.state.teacherForm;\n    await updateTeacher(teacherForm.id, teacherForm);\n    this.setState(prevState => ({\n      teachers: prevState.teachers.map(teacher => teacher.id === teacherForm.id ? teacherForm : teacher)\n    }));\n  }\n\n  async deleteActivity(id) {\n    await destroyTeacher(id);\n    this.setState(prevState => ({\n      teachers: prevState.teachers.filter(teacher => teacher.id !== id)\n    }));\n  }\n\n  handleFormChange(e) {\n    const _e$target = e.target,\n          name = _e$target.name,\n          value = _e$target.value;\n    this.setState(prevState => ({\n      teacherForm: _objectSpread({}, prevState.teacherForm, {\n        [name]: value\n      })\n    }));\n  }\n\n  async mountEditForm(id) {\n    const teachers = await readAllTeachers();\n    const teacher = teachers.find(el => el.id === parseInt(id));\n    this.setState({\n      teacherForm: teacher\n    });\n  } // -------------- AUTH ------------------\n\n\n  handleLoginButton() {\n    this.props.history.push(\"/login\");\n  }\n\n  async handleLogin() {\n    const userData = await loginUser(this.state.authFormData);\n    this.setState({\n      currentUser: decode(userData.token)\n    });\n    localStorage.setItem(\"jwt\", userData.token);\n  }\n\n  async handleRegister(e) {\n    e.preventDefault();\n    await registerUser(this.state.authFormData);\n    this.handleLogin();\n  }\n\n  handleLogout() {\n    localStorage.removeItem(\"jwt\");\n    this.setState({\n      currentUser: null\n    });\n  }\n\n  authHandleChange(e) {\n    const _e$target2 = e.target,\n          name = _e$target2.name,\n          value = _e$target2.value;\n    this.setState(prevState => ({\n      authFormData: _objectSpread({}, prevState.authFormData, {\n        [name]: value\n      })\n    }));\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, React.createElement(\"header\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      onClick: () => this.setState({\n        teacherForm: {\n          name: \"\",\n          photo: \"\"\n        }\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"School App\")), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, this.state.currentUser ? React.createElement(React.Fragment, null, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, this.state.currentUser.username), React.createElement(\"button\", {\n      onClick: this.handleLogout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }, \"logout\")) : React.createElement(\"button\", {\n      onClick: this.handleLoginButton,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"Login/register\"))), React.createElement(Route, {\n      exact: true,\n      path: \"/login\",\n      render: () => React.createElement(Login, {\n        handleLogin: this.handleLogin,\n        handleChange: this.authHandleChange,\n        formData: this.state.authFormData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/register\",\n      render: () => React.createElement(Register, {\n        handleRegister: this.handleRegister,\n        handleChange: this.authHandleChange,\n        formData: this.state.authFormData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }), React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => React.createElement(TeachersView, {\n        teachers: this.state.teachers,\n        teacherForm: this.state.teacherForm,\n        handleFormChange: this.handleFormChange,\n        newTeacher: this.newTeacher,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/new/teacher\",\n      render: () => React.createElement(CreateTeacher, {\n        handleFormChange: this.handleFormChange,\n        teacherForm: this.state.teacherForm,\n        newTeacher: this.newTeacher,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/teachers/:id\",\n      render: props => {\n        const id = props.match.params.id;\n        const teacher = this.state.teachers.find(el => el.id === parseInt(id));\n        return React.createElement(TeacherPage, {\n          id: id,\n          teacher: teacher,\n          handleFormChange: this.handleFormChange,\n          mountEditForm: this.mountEditForm,\n          editActivity: this.editActivity,\n          teacherForm: this.state.teacherForm,\n          deleteTeacher: this.deleteTeacher,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default withRouter(App);","map":{"version":3,"sources":["/Users/user/ga/project4/copilot/copilot_app/client/src/App.js"],"names":["React","Component","Route","Link","withRouter","decode","Login","Register","loginUser","registerUser","App","constructor","props","state","activities","activityForm","name","category","currentUser","authFormData","username","email","password","handleFormChange","bind","mountEditForm","editActivity","deleteActivity","newActivity","handleLoginButton","handleLogin","handleRegister","handleLogout","authHandleChange","componentDidMount","getTeachers","checkUser","localStorage","getItem","user","setState","teachers","readAllTeachers","e","preventDefault","teacher","createTeacher","teacherForm","prevState","photo","updateTeacher","id","map","destroyTeacher","filter","target","value","find","el","parseInt","history","push","userData","token","setItem","removeItem","render","newTeacher","match","params","deleteTeacher"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Route, Link } from 'react-router-dom';\nimport { withRouter } from 'react-router';\nimport decode from 'jwt-decode';\n\n// import TeachersView from './components/TeachersView';\n// import TeacherPage from './components/TeacherPage';\n// import CreateTeacher from './components/CreateTeacher'\nimport Login from './components/Login'\nimport Register from './components/Register'\n\nimport {\n  // createTeacher,\n  // readAllTeachers,\n  // updateTeacher,\n  // destroyTeacher,\n  loginUser,\n  registerUser\n} from './services/api-helper'\n\nimport './App.css';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      activities: [],\n      activityForm: {\n        name: \"\",\n        category: \"\"\n      },\n      currentUser: null,\n      authFormData: {\n        username: \"\",\n        email: \"\",\n        password: \"\"\n      }\n    };\n    this.handleFormChange = this.handleFormChange.bind(this)\n    this.mountEditForm = this.mountEditForm.bind(this)\n    this.editActivity = this.editActivity.bind(this)\n    this.deleteActivity = this.deleteActivity.bind(this)\n    this.newActivity = this.newActivity.bind(this)\n    this.handleLoginButton = this.handleLoginButton.bind(this)\n    this.handleLogin = this.handleLogin.bind(this)\n    this.handleRegister = this.handleRegister.bind(this)\n    this.handleLogout = this.handleLogout.bind(this)\n    this.authHandleChange = this.authHandleChange.bind(this)\n  }\n\n  componentDidMount() {\n    this.getTeachers();\n    const checkUser = localStorage.getItem(\"jwt\");\n    if (checkUser) {\n      const user = decode(checkUser);\n      this.setState({\n        currentUser: user\n      })\n    }\n  }\n\n  async getTeachers() {\n    const teachers = await readAllTeachers();\n    this.setState({\n      teachers\n    })\n  }\n\n  async newActivity(e) {\n    e.preventDefault();\n    const teacher = await createTeacher(this.state.teacherForm);\n    this.setState(prevState => ({\n      teachers: [...prevState.teachers, teacher],\n      teacherForm: {\n        name: \"\",\n        photo: \"\"\n      }\n    }))\n  }\n\n  async editActivity() {\n    const { teacherForm } = this.state\n    await updateTeacher(teacherForm.id, teacherForm);\n    this.setState(prevState => (\n      {\n        teachers: prevState.teachers.map(teacher => teacher.id === teacherForm.id ? teacherForm : teacher),\n      }\n    ))\n  }\n\n  async deleteActivity(id) {\n    await destroyTeacher(id);\n    this.setState(prevState => ({\n      teachers: prevState.teachers.filter(teacher => teacher.id !== id)\n    }))\n  }\n\n  handleFormChange(e) {\n    const { name, value } = e.target;\n    this.setState(prevState => ({\n      teacherForm: {\n        ...prevState.teacherForm,\n        [name]: value\n      }\n    }))\n  }\n\n  async mountEditForm(id) {\n    const teachers = await readAllTeachers();\n    const teacher = teachers.find(el => el.id === parseInt(id));\n    this.setState({\n      teacherForm: teacher\n    });\n  }\n\n  // -------------- AUTH ------------------\n\n  handleLoginButton() {\n    this.props.history.push(\"/login\")\n  }\n\n  async handleLogin() {\n    const userData = await loginUser(this.state.authFormData);\n    this.setState({\n      currentUser: decode(userData.token)\n    })\n    localStorage.setItem(\"jwt\", userData.token)\n  }\n\n  async handleRegister(e) {\n    e.preventDefault();\n    await registerUser(this.state.authFormData);\n    this.handleLogin();\n  }\n\n  handleLogout() {\n    localStorage.removeItem(\"jwt\");\n    this.setState({\n      currentUser: null\n    })\n  }\n\n  authHandleChange(e) {\n    const { name, value } = e.target;\n    this.setState(prevState => ({\n      authFormData: {\n        ...prevState.authFormData,\n        [name]: value\n      }\n    }));\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <header>\n          <h1><Link to='/' onClick={() => this.setState({\n            teacherForm: {\n              name: \"\",\n              photo: \"\"\n            }\n          })}>School App</Link></h1>\n          <div>\n          {this.state.currentUser\n            ?\n            <>\n              <p>{this.state.currentUser.username}</p>\n              <button onClick={this.handleLogout}>logout</button>\n            </>\n            :\n            <button onClick={this.handleLoginButton}>Login/register</button>\n          }\n          </div>\n        </header>\n        <Route exact path=\"/login\" render={() => (\n          <Login\n            handleLogin={this.handleLogin}\n            handleChange={this.authHandleChange}\n            formData={this.state.authFormData} />)} />\n        <Route exact path=\"/register\" render={() => (\n          <Register\n            handleRegister={this.handleRegister}\n            handleChange={this.authHandleChange}\n            formData={this.state.authFormData} />)} />\n        <Route\n          exact path=\"/\"\n          render={() => (\n            <TeachersView\n              teachers={this.state.teachers}\n              teacherForm={this.state.teacherForm}\n              handleFormChange={this.handleFormChange}\n              newTeacher={this.newTeacher} />\n          )}\n        />\n        <Route\n          path=\"/new/teacher\"\n          render={() => (\n            <CreateTeacher\n              handleFormChange={this.handleFormChange}\n              teacherForm={this.state.teacherForm}\n              newTeacher={this.newTeacher} />\n          )} />\n        <Route\n          path=\"/teachers/:id\"\n          render={(props) => {\n            const { id } = props.match.params;\n            const teacher = this.state.teachers.find(el => el.id === parseInt(id));\n            return <TeacherPage\n              id={id}\n              teacher={teacher}\n              handleFormChange={this.handleFormChange}\n              mountEditForm={this.mountEditForm}\n              editActivity={this.editActivity}\n              teacherForm={this.state.teacherForm}\n              deleteTeacher={this.deleteTeacher} />\n          }}\n        />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(App);"]},"metadata":{},"sourceType":"module"}